spring:
  application:
    name: SSAIREN

  # 데이터소스 설정
  datasource:
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
    driver-class-name: org.postgresql.Driver

  # JPA 설정
  jpa:
    hibernate:
      ddl-auto: update  # 테이블 구조만 업데이트 (데이터 유지)
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        show_sql: true
    show-sql: true
    defer-datasource-initialization: true

  # SQL 초기화 설정
  sql:
    init:
      mode: never  # 서버 재시작 시 중복 데이터 삽입 방지
      data-locations: classpath:data.sql
      encoding: UTF-8

  # 파일 업로드 설정
  servlet:
    multipart:
      enabled: true
      max-file-size: 500MB
      max-request-size: 500MB

  # Redis 설정
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: 3000ms
      lettuce:
        pool:
          max-active: 10
          max-idle: 10
          min-idle: 2

# MinIO 객체 스토리지 설정
minio:
  endpoint: ${MINIO_ENDPOINT:http://minio:9000}
  access-key: ${MINIO_ACCESS_KEY}
  secret-key: ${MINIO_SECRET_KEY}
  bucket-name: ${MINIO_BUCKET_NAME:audio-files}
  video-bucket-name: ${MINIO_VIDEO_BUCKET_NAME:video-files}
  # 파일 크기 제한 (MB)
  max-audio-file-size: 50
  max-video-file-size: 500

# AI 서버 설정
ai:
  server:
    base-url: ${AI_SERVER_BASE_URL:https://ai.ssairen.site}
    timeout: 300  # 초 (5분)

# JWT 인증 설정
jwt:
  secret: ${JWT_SECRET}
  access-token-expiration: ${JWT_ACCESS_TOKEN_EXPIRATION:900000}      # 15분 (기본값)
  refresh-token-expiration: ${JWT_REFRESH_TOKEN_EXPIRATION:604800000} # 7일 (기본값)

# Actuator 헬스체크 및 모니터링 설정
management:
  endpoints:
    web:
      exposure:
        # 모든 엔드포인트를 노출 (프로덕션에서는 필요한 것만 선택적으로 노출)
        include: health,info,metrics,prometheus,env,beans,conditions,configprops,mappings
      base-path: /actuator
  endpoint:
    health:
      # 상세한 헬스 정보 표시
      show-details: always
      show-components: always
      # 프로브 엔드포인트 활성화 (Kubernetes 등에서 사용)
      probes:
        enabled: true
  health:
    # 각종 헬스 인디케이터 설정
    livenessState:
      enabled: true
    readinessState:
      enabled: true
    # 디스크 공간 체크
    diskspace:
      enabled: true
      threshold: 10MB
  # 메트릭 설정
  metrics:
    enable:
      jvm: true
      system: true
      tomcat: true
    export:
      prometheus:
        enabled: true
    tags:
      application: ${spring.application.name}
  # 애플리케이션 정보 설정
  info:
    env:
      enabled: true
    java:
      enabled: true
    os:
      enabled: true

# 애플리케이션 정보
info:
  app:
    name: SSAIREN
    description: SSAFY 13기 A205팀 프로젝트
    version: 0.0.1-SNAPSHOT
    encoding: UTF-8
    java:
      version: 21

# ===================================================================
# Swagger/OpenAPI 설정 (API Documentation)
# ===================================================================
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha

# ===================================================================
# 로깅 설정 (Logging Configuration)
# ===================================================================
logging:
  level:
    # 전역 로깅 레벨 설정
    root: WARN
    # SSAIREN 애플리케이션 로그를 TRACE 레벨로 설정 (Service, Repository 로그 출력)
    com.ssairen: TRACE